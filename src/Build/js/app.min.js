document.querySelector("body").setAttribute("trasition","none");const errors={modal_argument_constructor:"The argument in the constructor of the Modal class must be object.",modal_argument_content:"The argument in the content of the Modal class must be object.",access_forbiden:"Доступ Запрещен!",number_create_columns:"Укажите кол-во создаваемых колонок!",name_column:"Имя столбца",type_column:"Тип",length_column:"Длина",default_column:"По умолчанию",his_default_column:"Свое по умолчанию",charset_column:"Кодировка",fetch_request_error:"Произойшла ошибка. Повторите попытку снова!"};class Modal{_id={};_auto_open={};_auto_open_time={};_hide_prev={};_insert={};_title={};constructor(e=!1,...t){if("object"!=typeof t)throw new Error(errors.modal_argument_constructor);this.arrayModal=e,this.modals=!0===e?t[0]:t}_defaultArguments(){if(this.modals.length>0)for(let e=0;e<this.modals.length;e++){const t=this.modals[e];this._id[e]=t.id??"",this._auto_open[e]=Boolean(t.auto_open)??!1,this._auto_open_time[e]=t.auto_open_time??!1,this._hide_prev[e]=Boolean(t.hide_prev)??!0,this._insert[e]=t.insert??"body",this._title[e]=t.title??""}}_createElementsModal(e="No Title",t=null,n,o="",r){let l=document.createElement("div");l.classList.add("modal-container"),l.setAttribute("modal-id-open",t);let c=document.createElement("div");c.classList.add("modal-full-fon"),c.setAttribute("modal-close",t);let i=document.createElement("div");i.classList.add("modal-content-restrictions"),i.style.height=this.modals[r].height??"200px";let a=document.createElement("div");a.classList.add("modal-content");let s=document.createElement("div");s.classList.add("modal-title");let u=document.createElement("h5");u.innerHTML=e;let d=document.createElement("span");d.classList.add("modal-close"),d.innerHTML='<i class="fal fa-times"></i>',d.setAttribute("modal-close",t),u.innerHTML+=d.outerHTML,s.innerHTML=u.outerHTML,a.innerHTML=s.outerHTML,a.innerHTML+=o,i.innerHTML=a.outerHTML,l.innerHTML=i.outerHTML,l.innerHTML+=c.outerHTML,document.querySelector(n).innerHTML+=l.outerHTML}_eventRenderWindow(){let e={};for(let t=0;t<this.modals.length;t++)this._createElementsModal(this._title[t],this._id[t],this._insert[t],this.content[t].content,t),e[this._id[t]]={id:this._id[t],auto_open:this._auto_open[t],auto_open_time:this._auto_open_time[t],hide_prev:this._hide_prev[t],insert:this._insert[t],title:this._title[t]};const t=document.querySelectorAll("[button-open-modal]"),n=Object.keys(e);for(let t=0;t<Object.keys(e).length;t++){let o=document.querySelectorAll("[modal-close]");for(let e=0;e<o.length;e++){const t=o[e].attributes["modal-close"].nodeValue;o[e].onclick=()=>{document.querySelector("[modal-id-open="+t+"]").classList.remove("active")}}!0===e[n[t]].auto_open&&(!0===e[n[t]].hide_prev&&document.querySelector("[modal-id-open]").classList.remove("active"),document.querySelector("[modal-id-open="+n[t]+"]").classList.add("active")),!1!==e[n[t]].auto_open_time&&"number"==typeof e[n[t]].auto_open_time&&(!0===e[n[t]].hide_prev&&document.querySelector("[modal-id-open]").classList.remove("active"),setTimeout(()=>{document.querySelector("[modal-id-open="+n[t]+"]").classList.add("active")},1e3*e[n[t]].auto_open_time))}for(let e=0;e<t.length;e++)t[e].addEventListener("click",()=>{const n=t[e].attributes["button-open-modal"].nodeValue;!0===n.hide_prev&&document.querySelector("[modal-id-open]").classList.remove("active"),document.querySelector("[modal-id-open="+n+"]").classList.add("active")})}content(...e){if("object"!=typeof e)throw new Error(errors.modal_argument_content);return!0===this.arrayModal?this.content=e[0]:this.content=e,this}render(){this._defaultArguments(),this._eventRenderWindow()}}function deleteColumn(e){let t=document.querySelector('[data-id-column="'+e+'"]');t.style.transform="scale(0)",setTimeout(()=>{t.remove()},200)}window.onload=e=>{const t={body:document.querySelector("body"),btn_loader:document.querySelectorAll("[btn-loader]"),show_all_tables:document.querySelectorAll(".db-container-click"),checkbox:document.querySelectorAll('input[type="checkbox"]'),select_all_checkbox:document.querySelectorAll("[select-checkbox]"),forbidden:document.querySelectorAll("[data-forbidden]"),add_column:document.querySelector(".btn-add-column"),value_add_column:document.querySelector(".num-add-column"),form_create_table_section:document.querySelectorAll("#create-table-form section"),form_create_table:document.querySelector(".sections-form-create-table"),deleteColumnForm:document.querySelectorAll(".full-width .close-column"),draggable_column_form:document.querySelectorAll(".sections-form-create-table section"),request_form:document.querySelectorAll("[data-fetch]"),dinamic_btn:document.querySelectorAll("[dinamic-btn]"),dinamic_pages:document.querySelectorAll("[name-dinamic-page]"),show_data_history_sender:document.querySelectorAll(".show_data_sender"),history_close:document.querySelectorAll(".delete-history"),timer:document.querySelectorAll("[timer]")};if(0===t.body.classList.length&&t.body.classList.add(config.theme),setTimeout(()=>{t.body.removeAttribute("trasition")},500),t.btn_loader.length>0)for(let e=0;e<t.btn_loader.length;e++){const n=t.btn_loader[e].attributes["btn-loader"].nodeValue,o=config.btn_loader;t.btn_loader[e].textContent;t.btn_loader[e].addEventListener("click",r=>{t.btn_loader[e].innerHTML="default"==n?o:n})}if(t.show_all_tables.length>0)for(let e=0;e<t.show_all_tables.length;e++)t.show_all_tables[e].addEventListener("click",()=>{t.show_all_tables[e].classList.contains("active")?t.show_all_tables[e].classList.remove("active"):t.show_all_tables[e].classList.add("active")});if(t.checkbox.length>0)for(let e=0;e<t.checkbox.length;e++)if(t.checkbox[e].attributes["empty-checkbox"]&&!0===Boolean(t.checkbox[e].attributes["empty-checkbox"].nodeValue)){const n=t.checkbox[e].attributes;let o=document.createElement("input");t.checkbox[e].removeAttribute("empty-checkbox"),o.setAttribute("type","hidden"),o.setAttribute("name",n.name.nodeValue??""),o.setAttribute("value","off"),t.checkbox[e].parentElement.prepend(o)}if(t.forbidden.length>0)for(let e=0;e<t.forbidden.length;e++){let n=t.forbidden[e];n.style.position="relative";let o=document.createElement("span");o.classList.add("forbidden"),o.innerHTML=errors.access_forbiden,n.appendChild(o)}if(null!==t.add_column&&(t.add_column.onclick=()=>{let e=t.value_add_column;if(""==e.value||"number"!=typeof Number(e.value)||Number(e.value)<1)alert(errors.number_create_columns);else{let n=Number(e.value);document.querySelector(".loader-add-column-block").innerHTML='<i class="loader-add-column-in-form far fa-spinner-third fa-spin" style="width: max-content"></i>',setTimeout(()=>{for(let e=0;e<n;e++){let o=Math.round(9999*Math.random()-0),r=document.createElement("section");r.classList.add("full-width"),r.setAttribute("data-id-column",o),r.setAttribute("draggable",!0);let l=document.createElement("div"),c=document.createElement("label");c.setAttribute("for","");let i=document.createElement("input");i.setAttribute("type","text"),i.setAttribute("name","name-column["+document.querySelectorAll("#create-table-form section").length+"]"),i.setAttribute("placeholder",errors.name_column);let a=document.createElement("div"),s=document.createElement("label");s.setAttribute("for","");let u=document.createElement("select");u.setAttribute("name","type["+document.querySelectorAll("#create-table-form section").length+"]");let d=document.createElement("div"),m=document.createElement("label");m.setAttribute("for","");let h=document.createElement("input");h.setAttribute("type","text"),h.setAttribute("name","length["+document.querySelectorAll("#create-table-form section").length+"]"),h.setAttribute("placeholder",errors.length_column);let f=document.createElement("div"),b=document.createElement("label");b.setAttribute("for","");let y=document.createElement("select");y.setAttribute("name","default["+document.querySelectorAll("#create-table-form section").length+"]");let _=document.createElement("input");_.setAttribute("type","text"),_.setAttribute("name","other-default["+document.querySelectorAll("#create-table-form section").length+"]"),_.setAttribute("placeholder",errors.his_default_column);let g=document.createElement("div"),L=document.createElement("label");s.setAttribute("for","");let p=document.createElement("select");p.setAttribute("name","charset["+document.querySelectorAll("#create-table-form section").length+"]");let M=document.createElement("span");M.classList.add("close-column"),M.setAttribute("onclick","deleteColumn("+o+")"),M.innerHTML='<i class="fal fa-times"></i>';for(let e=0;e<Object.keys(types).length;e++){let t=document.createElement("option");t.setAttribute("value",Object.keys(types)[e]),t.innerHTML=types[Object.keys(types)[e]],u.innerHTML+=t.outerHTML}for(let e=0;e<Object.keys(defaults).length;e++){let t=document.createElement("option");t.setAttribute("value",Object.keys(defaults)[e]),t.innerHTML=defaults[Object.keys(defaults)[e]],y.innerHTML+=t.outerHTML}for(let e=0;e<Object.keys(charsets).length;e++){let t=document.createElement("option");t.setAttribute("value",Object.keys(charsets)[e]),t.innerHTML=charsets[Object.keys(charsets)[e]],p.innerHTML+=t.outerHTML}c.innerHTML=errors.name_column,l.innerHTML+=c.outerHTML,l.innerHTML+=i.outerHTML,r.innerHTML=l.outerHTML,s.innerHTML=errors.type_column,a.innerHTML+=s.outerHTML,a.innerHTML+=u.outerHTML,r.innerHTML+=a.outerHTML,m.innerHTML=errors.length_column,d.innerHTML+=m.outerHTML,d.innerHTML+=h.outerHTML,r.innerHTML+=d.outerHTML,b.innerHTML=errors.default_column,f.innerHTML+=b.outerHTML,f.innerHTML+=y.outerHTML,f.innerHTML+=_.outerHTML,r.innerHTML+=f.outerHTML,L.innerHTML=errors.charset_column,g.innerHTML+=L.outerHTML,g.innerHTML+=p.outerHTML,r.innerHTML+=g.outerHTML,r.innerHTML+=M.outerHTML,e+1==n&&document.querySelector(".loader-add-column-in-form").remove(),t.form_create_table.append(r)}},100)}}),t.draggable_column_form.length>0){let e;t.draggable_column_form.forEach((t,n,o)=>{t.addEventListener("dragstart",n=>{e=n.target,setTimeout(()=>{t.classList.add("drag-column")},0)}),t.addEventListener("dragend",()=>{setTimeout(()=>{t.classList.remove("drag-column")},0)}),t.addEventListener("dragenter",e=>{t.classList.add("drag-border")}),t.addEventListener("dragleave",e=>{t.classList.remove("drag-border")}),t.addEventListener("dragover",e=>{e.preventDefault()}),t.addEventListener("drop",n=>{n.preventDefault();e.getAttribute("data-id-column")!=t.getAttribute("data-id-column")&&(t.innerHTML=e.outerHTML,e.innerHTML=t.outerHTML)})})}const n=function(e,t){let n=document.createElement("div");n.classList.add("notification-container"),n.classList.add(e);let o=document.createElement("div");o.classList.add("content-notification"),o.classList.add("active");let r=document.createElement("span"),l=document.createElement("span");l.classList.add("notification-icon");let c=document.createElement("span");c.classList.add("not-mess"),c.innerHTML=t,r.innerHTML+=l.outerHTML,r.innerHTML+=c.outerHTML,o.innerHTML+=r.outerHTML,n.innerHTML+=o.outerHTML,document.querySelector(".content-all-notifications").prepend(n);let i=document.querySelectorAll(".content-all-notifications div > div");for(let e=0;e<i.length;e++)setTimeout(()=>{i[e].classList.add("hide"),setTimeout(()=>{i[e].remove()},700)},config.notifications_time)};t.request_form.forEach((e,t,o)=>{e.addEventListener("submit",t=>{t.preventDefault();let o=t.submitter.textContent;t.submitter.innerHTML='<i class="far fa-spinner-third fa-spin"></i>',t.submitter.setAttribute("disabled","");let r=e.getAttribute("action"),l=e.getAttribute("method"),c=new FormData(e);fetch(r,{method:l,body:c}).then(e=>{t.submitter.innerHTML=o,t.submitter.removeAttribute("disabled",""),!1===e.ok&&n("warning",errors.fetch_request_error),e.text().then(e=>{const t=JSON.parse(e);n(t.status,t.message),t.redirect&&null!==t.redirect&&(location.href=t.redirect),console.log(e)})}).catch(e=>{n("warning",e)})})});const o=function(e,t,o){let r;r="GET"===t?{method:t}:{method:t,body:JSON.stringify(o)},fetch(e,r).then(e=>{!1===e.ok&&n("warning",errors.fetch_request_error),e.text().then(e=>{console.log(e);const t=JSON.parse(e);n(t.status,t.message),t.redirect&&(location.href=t.redirect)})})};if(document.querySelectorAll("#as-save-deleted-data").forEach(e=>{e.onchange=()=>{o("/fastdb/settings/saving-deleted-data","POST",{"as-save-deleted-data":e.value})}}),document.querySelectorAll("#save-deleted-data").forEach(e=>{e.onchange=()=>{o("/fastdb/settings/turn-deleted-data","POST",{"save-deleted-data":1==e.checked?"on":"off"})}}),document.querySelectorAll(".banned-account").forEach(e=>{e.onchange=()=>{o("/fastdb/users/banned-account","POST",{"banned-account":1==e.checked?"on":"off","user-hash":e.getAttribute("user-hash")})}}),null!==t.dinamic_btn&&void 0!==t.dinamic_btn&&t.dinamic_btn.length>0)for(let e=0;e<t.dinamic_btn.length;e++){const n=t.dinamic_btn[e],o=t.dinamic_pages;n.onclick=function(){for(let e=0;e<t.dinamic_btn.length;e++)t.dinamic_btn[e].classList.remove("active");const e=this.attributes["dinamic-btn"].nodeValue;n.classList.add("active"),o.forEach((t,n,o)=>{o[n].classList.remove("active"),o[n].getAttribute("name-dinamic-page")===e&&o[n].classList.add("active")})}}const r=document.querySelector(".range-size-icon-menu"),l=document.querySelector(".range-size-text-menu"),c=document.querySelector(".num-size-icon-menu"),i=document.querySelector(".num-size-text-menu"),a=document.querySelectorAll(".item-menu i"),s=document.querySelectorAll(".item-menu span"),u=document.querySelector(".change-display-icon-menu"),d=document.querySelector(".change-display-text-menu"),m=document.querySelector(".display-logo"),h=document.querySelector(".logo-sitebar-left"),f=document.querySelector(".display-info-connect"),b=document.querySelector(".container-info-server"),y=document.querySelector(".display-used-memory"),_=document.querySelector(".container-memory"),g=localStorage.desin?JSON.parse(window.localStorage.desin):{},L=config.default_interface,p=function(e){null!==c&&(c.innerHTML=e),null!==a&&a.forEach(t=>{t.style.fontSize=e+"px"}),null!==r&&(r.value=e)},M=function(e){null!==i&&(i.innerHTML=e),null!==s&&s.forEach(t=>{t.style.fontSize=e+"px"}),null!==l&&(l.value=e)},T=function(e){null!==a&&a.forEach(t=>{t.style.display=!0===e?"revert":"none"}),null!==u&&(u.checked=e)},v=function(e){null!==s&&s.forEach(t=>{t.style.display=!0===e?"revert":"none"}),null!==d&&(d.checked=e)},S=function(e){null!==h&&(h.style.display=!0===e?"revert":"none"),null!==m&&(m.checked=e)},H=function(e){null!==b&&(b.style.display=!0===e?"revert":"none"),null!=f&&(f.checked=e)},A=function(e){null!==_&&(_.style.display=!0===e?"revert":"none"),null!=y&&(y.checked=e)};let q={sizeIcon:g.sizeIcon??L.menu.sizeIcon,sizeText:g.sizeText??L.menu.sizeText,showIconMenu:g.showIconMenu??L.menu.showIconMenu,showTextMenu:g.showTextMenu??L.menu.showTextMenu,showLogo:g.showLogo??L.content.showLogo,showInfoConnect:g.showInfoConnect??L.sitebarRight.showDataConnection,usedMemory:g.usedMemory??L.sitebarRight.usedMemory};p(q.sizeIcon),M(q.sizeText),T(q.showIconMenu),v(q.showTextMenu),S(q.showLogo),H(q.showInfoConnect),A(q.usedMemory),null!==r&&(r.oninput=function(){p(this.value),q.sizeIcon=this.value,localStorage.setItem("desin",JSON.stringify(q))}),null!==l&&(l.oninput=function(){M(this.value),q.sizeText=this.value,localStorage.setItem("desin",JSON.stringify(q))}),null!==u&&(u.onchange=function(){T(this.checked),q.showIconMenu=this.checked,localStorage.setItem("desin",JSON.stringify(q))}),null!==d&&(d.onchange=function(){v(this.checked),q.showTextMenu=this.checked,localStorage.setItem("desin",JSON.stringify(q))}),null!==m&&(m.onchange=function(){S(this.checked),q.showLogo=this.checked,localStorage.setItem("desin",JSON.stringify(q))}),null!==f&&(f.onchange=function(){H(this.checked),q.showInfoConnect=this.checked,localStorage.setItem("desin",JSON.stringify(q))}),null!==y&&(y.onchange=function(){A(this.checked),q.usedMemory=this.checked,localStorage.setItem("desin",JSON.stringify(q))});let k=document.querySelectorAll("[select-all-checkbox]"),w=document.querySelectorAll("[select-checkbox]");const E=function(e){const t=e.getAttribute("select-all-checkbox");w.forEach(n=>{n.getAttribute("select-checkbox")==t&&(n.checked=e.checked)})},x=function(e){let t=document.querySelectorAll("[select-checkbox="+e+"]"),n=document.querySelector("[select-all-checkbox="+e+"]"),o=0;t.forEach(e=>{!0===e.checked?o++:o--}),o===t.length?n.checked=!0:n.checked=!1};if(null!==k&&k.length>0)for(let e=0;e<k.length;e++){k[e].getAttribute("select-all-checkbox");k[e].onchange=function(){E(this)}}if(null!==w&&w.length>0)for(let e=0;e<w.length;e++)x(w[e].getAttribute("select-checkbox")),w[e].onchange=function(){x(this.getAttribute("select-checkbox"))};let I=document.querySelector(".num-select-memory"),O=document.querySelector("#range-memory-in-create-user");null!==O&&(O.oninput=function(){I.innerHTML=this.value}),null!==t.show_data_history_sender&&t.show_data_history_sender.length>0&&t.show_data_history_sender.forEach((e,t,n)=>{e.onclick=e=>{e.path[4].children[1].classList.contains("active")?e.path[4].children[1].classList.remove("active"):e.path[4].children[1].classList.add("active")}}),null!==t.history_close&&t.history_close.length>0&&t.history_close.forEach(e=>{const t=e.getAttribute("history-close-id");e.onclick=()=>{o("/fastdb/history/delete/"+t,"GET"),document.querySelector('[history-id="'+t+'"]').style.transform="scale(0)",setTimeout(()=>{document.querySelector('[history-id="'+t+'"]').remove()},300)}}),document.querySelectorAll("[edit-field]").forEach((e,t,n)=>{e.ondblclick=()=>{e.innerText;const o=e.innerHTML,r=e;let l=document.createElement("textarea");l.innerHTML=o,l.style.width="98%",l.style.height="100%",r.innerHTML=l.outerHTML;const c=e,i=c.querySelector("textarea");i.focus(),i.setSelectionRange(-1,-1),i.onblur=function(){const e=this.value;c.innerHTML=e,n[t].getAttribute("edit-field-func")&&n[t]},i.onkeyup=function(e){const t=e.keyCode;if(13===t&&!0===e.shiftKey)return!1;13===t&&i.blur()}}});let z=document.querySelectorAll("th");null!==z&&z.forEach((e,t,n)=>{null!==e.querySelector("span.resize")&&void 0!==e.querySelector("span.resize")&&(e.querySelector("span.resize").onmousedown=t=>{window.addEventListener("mousemove",o),window.addEventListener("mouseup",(function e(t){window.removeEventListener("mousemove",o),window.removeEventListener("mouseup",e)}));let n=t.clientX;t.clientY;function o(t){let o=e.getBoundingClientRect();e.style.width=o.width-(n-t.clientX)+"px",n=t.clientX}})});[{name:"reload",func:()=>{location.reload()}},{name:"prev",func:()=>{history.go(-1)},funcHandler:e=>{""===document.referrer&&e.classList.add("banned")}},{name:"logout",func:()=>{location.href="/fastdb/logout"},funcHandler:e=>{"/fastdb/auth"===location.pathname&&e.classList.add("banned")}}].forEach((e,t,n)=>{contextMenu.event(e.name,(t,n)=>{e.funcHandler&&e.funcHandler(t,n),t.onclick=()=>{e.func(t,n),n.close()}})});let C=document.querySelector("#check-staticic-table"),N=document.querySelector(".table_statistics");if(null!==C){let e=JSON.parse(localStorage.getItem("tables"))??{};C.checked=e.check_staticics_table??!0,N.setAttribute("display",e.check_staticics_table??!0),C.onchange=()=>{localStorage.setItem("tables",JSON.stringify({check_staticics_table:C.checked})),N.setAttribute("display",C.checked)}}function j(){sessionStorage.now=Date.now(),setTimeout(j,25)}t.timer.length>0&&t.timer.forEach((e,t,n)=>{const o=e=>e<10?"0"+e:e,r=function(){let t=Date.parse(e.getAttribute("timer"))-Date.parse(new Date),n=o(Math.floor(t/1e3)%60),l=o(Math.floor(t/1e3/60%60)),c=o(Math.floor(t/36e5%24)),i=o(Math.floor(t/864e5));t<=0&&(clearInterval(r),n="00",l="00",c="00",i="00"),t>0&&(e.querySelector("[timer-seconds]").innerHTML=n,e.querySelector("[timer-minutes]").innerHTML=l,e.querySelector("[timer-hours]").innerHTML=c,e.querySelector("[timer-days]").innerHTML=i)};setInterval(r,1e3)}),window.onload=function(){var e=Date.now();if(sessionStorage.now){var t=e-parseInt(sessionStorage.now);console.log(t)}j()}},window.config={notifications_time:3e3,theme:"theme-dark",btn_loader:"<i class='far fa-spinner-third fa-spin'></i>",server:"333.333.33.33.3:3333",username:"default",request_time:6e4,default_interface:{menu:{showIconMenu:!0,showTextMenu:!0,sizeIcon:12,sizeText:12},content:{accentColor:"rgb(15, 164, 19)",accentColorLight:"rgb(18, 192, 22)",accentColorDark:"rgb(11, 117, 14)",showLogo:!0},sitebarRight:{showDataConnection:!0,usedMemory:!0}}};